# 短期ロードマップ（FE10 以降）

## サマリー

- 直近 4 週間で品質維持と UX 改善を並行し、マップ回りの回帰監視を強化する。
- バックログは P0〜P3 で優先度を明確化し、各項目の確認観点とドキュメント参照先を整理する。
- 実装着手は後続 PR で行い、本ドキュメントはタスク分解とトラッキングの起点とする。

## マイルストーン（4 週間）

| 週 | 期間 | マイルストーン | 主要アウトプット |
| --- | --- | --- | --- |
| Week 1 | W0–W1 | 回帰監視手順のドキュメント化と共有 | URL 履歴・ページネーションのチェックリスト、マップ操作確認観点の更新 |
| Week 2 | W1–W2 | UX 改善の要件整理 | クラスタ閾値調整の比較表、詳細パネルのフォーカス管理案 |
| Week 3 | W2–W3 | 品質・開発体験の整備 | 履歴×ページング統合テストの設計ドラフト、手動バンドル分析手順 |
| Week 4 | W3–W4 | 将来計画の意思決定準備 | ジオコーディング / i18n / 観測ガイドの調査結果メモ |

## 優先度別バックログ

### P0（最優先・品質維持）

- **URL 履歴・ページネーション回帰モニタリング**
  - `docs/testing-strategy.md` に記載するチェックリストに従い、URL クエリと Zustand の同期を毎リリースで確認する。
  - 主要観点: ブラウザ戻る／進む操作でフィルタとスクロール位置が復元されるか、`radius_km` とページ番号が乖離しないか。
- **近隣マップのズーム・ドラッグ挙動監視**
  - `docs/architecture.md` のフロント内部図を参照し、`NearbyMap` とストアのデータ同期を確認する。
  - チェック項目: 自動パン抑止がドラッグ後に解除されるか、クラスタ展開時にフォーカスが逸れないか、URL の中心座標が更新されるか。

### P1（UX 改善）

- **クラスタ閾値と展開ズームの調整計画**
  - 既存の MapLibre オプションとヒートマップのズーム閾値を比較する表を作成し、ユーザー観察ログから最適化案を検討する。
  - 影響範囲と検証観点をまとめ、次期スプリントで A/B 検証ができるよう準備する。
- **詳細パネルのモーション / フォーカス管理**
  - パネル開閉時のフォーカス遷移（ピン → パネル → 戻る）を確認する手順を整理し、スクリーンリーダー用アナウンス文を定義する。
  - 既存 UI を壊さずに導入できる CSS トランジション・`prefers-reduced-motion` 対応案をまとめる。

### P2（開発体験・品質）

- **履歴×ページングの統合テスト方針**
  - E2E ではなく、`useGymSearch` と `history` の整合性を単体・統合テストで担保するテストケースを `docs/testing-strategy.md` に基づいて定義する。
  - Playwright の削減により浮いたリソースを Vitest のシナリオ拡充に再配分する計画をまとめる。
- **バンドルサイズ計測スクリプト（手動）**
  - `docs/performance.md` の提案スクリプトに沿って、開発者が必要時に `next build` + `source-map-explorer` を実行できる手順書を作成する。
  - 実行結果を記録するフォーマット（CSV など）を定義し、リグレッション時の比較基準を用意する。

### P3（将来案）

- **ジオコーディング導入検討**
  - 候補 API（Mapbox、OpenCage など）を比較し、コスト・レート制限・プライバシー観点を整理する。
- **i18n の準備**
  - Next.js App Router での多言語対応方式（`next-intl` など）を調査し、文言管理ポリシーを決定する。
- **観測基盤のガイド整備**
  - Sentry / CloudWatch Logs / OpenTelemetry などの候補を比較し、FastAPI と Next.js 双方での導入ステップを調査する。

## リンク

- [テスト戦略](./testing-strategy.md)
- [パフォーマンス方針](./performance.md)
- [アクセシビリティ指針](./accessibility.md)
- [バックログ台帳](./backlog.md)
- [進捗サマリー](./fe10-progress.md)
